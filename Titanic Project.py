# -*- coding: utf-8 -*-
"""Untitled7.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/10_edIEzFZTW6taGEFMTvBuY0Fur76SL-
"""

import pandas as pd
import numpy as np

df = pd.read_csv("/content/drive/MyDrive/Colab Notebooks/ChanDarren_RaiTaran_Lab2a.csv")

Passengerid = df["PassengerId"].to_numpy()
print(Passengerid)

Survived = df["Survived"].to_numpy()
print(Survived)

Pclass = df["Pclass"].to_numpy()
print(Pclass)

Name = df["Name"].to_numpy()
print(Name)

Sex = df["Sex"].to_numpy()
print(Sex)

Age = df["Age"].to_numpy()
print(Age)

SibSp = df["SibSp"].to_numpy()
print(SibSp)

Parch = df["Parch"].to_numpy()
print(Parch)

Ticket = df["Ticket"].to_numpy()
print(Ticket)

Fare = df["Fare"].to_numpy()
print(Fare)

Cabin = df["Cabin"].to_numpy()
print(Cabin)

display(df.head())

Embarked = df["Embarked"].to_numpy()
print(Embarked )

Age_Series = df["Age"]
Fare_Series = df["Fare"]
Survived_Series = df["Survived"]

print("Age Series (first 5 values):")
print(Age_Series.head())
print("\nFare Series (first 5 values):")
print(Fare_Series.head())
print("\nSurvived Series (first 5 values):")
print(Survived_Series.head())

print("\nDataFrame Information:")
df.info()

print("\nDataFrame Descriptive Statistics:")
df.describe()

print("Missing values per column:")
print(df.isnull().sum())

mean_age = df['Age'].mean()
df['Age'].fillna(mean_age, inplace=True)
print(f"Missing values in 'Age' column after imputation: {df['Age'].isnull().sum()}")

mean_age = df['Age'].mean()
df['Age'] = df['Age'].fillna(mean_age)
print(f"Missing values in 'Age' column after imputation: {df['Age'].isnull().sum()}")

mode_embarked = df['Embarked'].mode()[0]
df['Embarked'] = df['Embarked'].fillna(mode_embarked)
print(f"Missing values in 'Embarked' column after imputation: {df['Embarked'].isnull().sum()}")

df['Cabin'] = df['Cabin'].fillna('Unknown')
print(f"Missing values in 'Cabin' column after imputation: {df['Cabin'].isnull().sum()}")

print("Verifying all missing values have been handled:")
print(df.isnull().sum())

specific_passengers_loc = df.loc[[0, 2, 4], ['Age', 'Fare', 'Survived']]
print("Details for PassengerId 1, 3, and 5 using .loc[] (indexed from 0):")
print(specific_passengers_loc)

specific_passengers_iloc = df.iloc[[0, 2, 4], [5, 9, 1]]
print("\nDetails for the 1st, 3rd, and 5th passengers using .iloc[]:")
print(specific_passengers_iloc)

df.rename(columns={'Sex': 'Gender'}, inplace=True)
print(df.columns)

pivot_table = df.pivot_table(values='Survived', index='Gender', columns='Pclass', aggfunc='mean')
print("\nMean Survival Rate by Gender and Pclass:")
print(pivot_table)

df_filtered_age = df[df['Age'] > 30]
print("DataFrame filtered for Age > 30 (first 5 rows):")
print(df_filtered_age.head())

df_filtered_fare = df_filtered_age[df_filtered_age['Fare'] > 50]
print("DataFrame filtered for Fare > 50 (first 5 rows):")
print(df_filtered_fare.head())

df_female_survivors = df_filtered_fare[(df_filtered_fare['Gender'] == 'female') & (df_filtered_fare['Survived'] == 1)]
print("DataFrame filtered for female survivors (Age > 30, Fare > 50) (first 5 rows):")
print(df_female_survivors.head())

df_sorted = df_female_survivors.sort_values(by=['Fare', 'Age', 'Survived'], ascending=[False, True, False])
print("DataFrame sorted by Fare (desc), Age (asc), and Survived (desc) (first 5 rows):")
print(df_sorted.head())

survival_rate_by_gender = df.groupby('Gender')['Survived'].mean()
print("Mean Survival Rate by Gender:")
print(survival_rate_by_gender)

average_age_by_pclass = df.groupby('Pclass')['Age'].mean()
print("Average Age by Passenger Class:")
print(average_age_by_pclass)

survival_count_by_embarked = df.groupby('Embarked')['Survived'].sum()
print("Total Survival Count by Embarked Location:")
print(survival_count_by_embarked)

data = {
    'PassengerId': [1, 2, 892, 4, 893, 6, 894, 895],
    'TicketCategory': ['Standard', 'Premium', 'Economy', 'Premium', 'Standard', 'Economy', 'Standard', 'Premium']
}
df_additional = pd.DataFrame(data)

print("Additional DataFrame (df_additional):")
print(df_additional.head())

df_merged = pd.merge(df, df_additional, on='PassengerId', how='inner')
print("Merged DataFrame (df_merged - first 5 rows):")
print(df_merged.head())

df_temp = df.set_index('PassengerId')
df_additional_indexed = df_additional.set_index('PassengerId')
df_joined = df_temp.join(df_additional_indexed, how='left', rsuffix='_additional')

print("Joined DataFrame (df_joined - first 5 rows):")
print(df_joined.head())

print("1. Row-wise Concatenation (df_concat_rows):")
df_concat_rows = pd.concat([df, df_additional], ignore_index=True)
print(df_concat_rows.head())
print(f"Shape of df_concat_rows: {df_concat_rows.shape}")

print("\n2. Column-wise Concatenation (df_concat_cols):")
df_concat_cols = pd.concat([df, df_additional], axis=1)
print(df_concat_cols.head())
print(f"Shape of df_concat_cols: {df_concat_cols.shape}")

average_age_by_survival = df.groupby('Survived')['Age'].mean()
print("Average Age by Survival Status:")
print(average_age_by_survival)

highest_fare = df['Fare'].max()
lowest_fare = df['Fare'].min()
print(f"Highest Fare Paid: {highest_fare}")
print(f"Lowest Fare Paid: {lowest_fare}")

overall_survival_percentage = (df['Survived'].sum() / len(df)) * 100
print(f"Overall Survival Percentage: {overall_survival_percentage:.2f}%")